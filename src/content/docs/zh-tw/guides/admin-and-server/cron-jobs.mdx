---
title: Cron作業
description: 了解如何監控和管理cron作業，包括查看作業執行歷史。
i18nReady: true
---

Cron作業是在Paideia LMS中自動執行的計劃任務。管理cron作業頁面提供對作業執行歷史的全面可見性，允許管理員追蹤作業執行模式、除錯失敗並監控系統效能。

## 概述

cron作業功能為管理員提供：

- **作業歷史**：查看所有cron作業的執行歷史
- **狀態監控**：查看哪些作業成功或失敗
- **錯誤詳情**：查看失敗作業的詳細錯誤訊息
- **執行追蹤**：監控作業執行時間戳和模式

## 存取Cron作業

要存取cron作業頁面：

1. 以管理員身份登入
2. 導航到 **管理 → 伺服器 → Cron作業**

您將看到所有cron作業及其執行歷史的全面檢視。

## 作業歷史顯示

作業歷史表顯示有關作業執行的詳細資訊：

### 表列

- **作業名稱**：作業的名稱（從任務slug或佇列派生）
- **任務Slug**：任務識別碼
- **佇列**：佇列名稱
- **執行時間**：作業開始執行的時間
- **完成時間**：作業完成執行的時間
- **狀態**：作業執行狀態（成功或失敗）
- **錯誤**：失敗作業的錯誤訊息

### 狀態指示器

- **綠色徽章**：作業成功
- **紅色徽章**：作業失敗

### 錯誤顯示

失敗的作業顯示詳細的錯誤資訊：

- **格式化顯示**：使用CodeHighlight元件顯示錯誤
- **複製功能**：輕鬆複製錯誤訊息以進行進一步分析
- **格式支援**：支援字串和JSON錯誤格式
- **可讀格式**：錯誤格式化為更好的可讀性

## 理解作業執行

### 成功的作業

成功的作業顯示：

- 綠色狀態徽章
- 執行時間戳
- 完成時間戳
- 無錯誤訊息

### 失敗的作業

失敗的作業顯示：

- 紅色狀態徽章
- 執行時間戳
- 完成時間戳（如果可用）
- 詳細的錯誤訊息

## 資料庫整合

作業歷史直接從資料庫檢索：

- **來源表**：`payload_jobs`和`payload_jobs_log`
- **查詢方法**：使用Drizzle ORM進行資料庫查詢
- **左連接**：即使日誌條目不存在，也包含所有作業
- **回退邏輯**：處理日誌可能不存在的情況

### PostgreSQL行為

PostgreSQL僅在`payload_jobs_log`中為失敗的作業建立日誌條目。查詢使用左連接確保所有作業都包含在歷史記錄中，即使日誌條目不存在。

## 歷史限制

作業歷史被限制以防止效能問題：

- **預設限制**：100個條目
- **排序**：最新的作業優先
- **可設定**：限制可以在函數中調整

## 常見用例

### 監控作業執行

使用作業歷史來：

- 追蹤作業執行模式隨時間的變化
- 識別頻繁失敗的作業
- 監控系統效能
- 了解作業執行狀態

### 除錯失敗的作業

當作業失敗時：

1. 檢查作業歷史表
2. 找到失敗的作業（紅色徽章）
3. 查看錯誤訊息
4. 複製錯誤以進行進一步分析
5. 調查根本原因

### 效能監控

監控作業執行以：

- 識別執行緩慢的作業
- 追蹤作業執行頻率
- 監控系統負載
- 最佳化作業排程

## 最佳實踐

### 定期監控

- 定期檢查作業歷史
- 監控失敗的作業
- 查看錯誤訊息
- 追蹤執行模式

### 錯誤分析

- 複製錯誤訊息進行分析
- 仔細查看錯誤詳情
- 檢查系統日誌以獲取其他上下文
- 調查根本原因

### 效能最佳化

- 監控作業執行時間
- 識別執行緩慢的作業
- 最佳化作業排程
- 根據需要調整作業頻率

## 故障排除

### 作業未出現在歷史中

如果作業未出現在歷史中：

1. 檢查作業是否實際執行
2. 驗證資料庫連線
3. 檢查系統日誌中的錯誤
4. 驗證作業設定

### 缺少日誌條目

如果缺少日誌條目：

- 這對於PostgreSQL中成功的作業是正常的
- 系統使用回退邏輯顯示作業資訊
- 如果需要，直接檢查`payload_jobs`表

### 錯誤訊息未顯示

如果錯誤訊息未顯示：

1. 檢查作業是否實際失敗
2. 驗證錯誤格式（字串或JSON）
3. 檢查瀏覽器控制台中的錯誤
4. 驗證CodeHighlight元件是否正常運作

## 相關功能

- [維護模式](/zh-tw/guides/admin-and-server/maintenance-mode/) - 在維護期間限制系統存取
- [設定指南](/zh-tw/guides/configuring-paideia/) - 了解系統設定
- [環境變數](/zh-tw/guides/environment-variables/) - 設定系統設定

