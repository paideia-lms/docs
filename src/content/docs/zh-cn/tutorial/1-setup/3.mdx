---
type: tutorial
title: 配置环境
description: |-
  Paideia LMS 入门教程 —
  设置数据库和存储，并配置环境变量
---

import Checklist from '~/components/Checklist.astro';
import Box from '~/components/tutorial/Box.astro';
import PreCheck from '~/components/tutorial/PreCheck.astro';
import { Steps } from '@astrojs/starlight/components';

<PreCheck>
  - 设置 PostgreSQL 数据库
  - 配置 S3 兼容存储
  - 设置环境变量
</PreCheck>

## 配置环境

在运行 Paideia LMS 之前，你需要设置数据库和存储，并配置环境变量。

### 设置 PostgreSQL

<Steps>
1. 确保 PostgreSQL 正在运行且可访问。如果你使用 Docker Compose，PostgreSQL 将包含在内。

2. 为 Paideia LMS 创建数据库：

   ```bash
   createdb paideia_db
   ```

   或者，如果你使用远程数据库，请通过数据库管理工具创建。
</Steps>

### 设置 S3 兼容存储

<Steps>
3. 设置 MinIO 或其他 S3 兼容存储服务。如果你使用 Docker Compose，MinIO 将包含在内。

   对于本地 MinIO 设置，你可以使用 Docker：

   ```bash
   docker run -d \
     -p 9000:9000 \
     -p 9001:9001 \
     -e MINIO_ROOT_USER=paideia_minio \
     -e MINIO_ROOT_PASSWORD=paideia_minio_secret \
     minio/minio server /data --console-address ":9001"
   ```

4. 为 Paideia LMS 创建存储桶。访问 `http://localhost:9001` 的 MinIO 控制台，创建一个名为 `paideia-bucket` 的存储桶。
</Steps>

### 配置环境变量

<Steps>
5. 在运行 Paideia LMS 之前设置环境变量：

   ```bash
   export DATABASE_URL="postgresql://user:password@localhost:5432/paideia_db"
   export S3_URL="http://localhost:9000"
   export S3_ACCESS_KEY="paideia_minio"
   export S3_SECRET_KEY="paideia_minio_secret"
   export S3_BUCKET="paideia-bucket"
   export PAYLOAD_SECRET="your-secure-random-string-here"
   ```

   :::caution[安全性]
   确保在生产环境中为 `PAYLOAD_SECRET` 使用安全的随机字符串。你可以使用以下命令生成：
   
   ```bash
   openssl rand -base64 32
   ```
   :::

6. 可选地，你可以在与二进制文件相同的目录中创建 `.env` 文件：

   ```bash
   cat > .env << EOF
   DATABASE_URL=postgresql://user:password@localhost:5432/paideia_db
   S3_URL=http://localhost:9000
   S3_ACCESS_KEY=paideia_minio
   S3_SECRET_KEY=paideia_minio_secret
   S3_BUCKET=paideia-bucket
   PAYLOAD_SECRET=your-secure-random-string-here
   EOF
   ```
</Steps>

恭喜！你的环境现在已经配置好，可以运行 Paideia LMS 了！

<Box icon="check-list">

## 任务清单

<Checklist>
- [ ] 我已经设置了 PostgreSQL 数据库。
- [ ] 我已经配置了 S3 兼容存储。
- [ ] 我已经设置了环境变量。
- [ ] 我准备好运行 Paideia LMS 了！
</Checklist>
</Box>
